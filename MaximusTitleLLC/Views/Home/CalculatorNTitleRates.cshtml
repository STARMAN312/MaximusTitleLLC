@{
    ViewData["Title"] = "Calculator & Title Rates - Maximus Title";
}

<link href="~/css/Home/CalculatorNTitleRates.css" rel="stylesheet" />

<div class="breadcrumb-header justify-content-between banner-container bg-primary pd-l-50 pd-r-50 pd-t-20 pd-b-20 mt-0 mb-0">
    <div class="left-content">
        <span class="main-content-title mg-b-0 mg-b-lg-1 text-white">CALCULATOR & TITLE RATES</span>
    </div>
    <div class="justify-content-center mt-2">
        <ol class="breadcrumb">
            <li class="breadcrumb-item tx-15"><a href="#" onclick="return false;">Home</a></li>
            <li class="breadcrumb-item active text-white" aria-current="page">Calculator & Title Rates</li>
        </ol>
    </div>
</div>
<div class="banner"></div>

<div class="d-flex flex-column mt-5 align-items-center">
    <span class="tx-20 text-primary tx-bold">CALCULATORS</span>

    <!-- Loan Payoff Calculator -->
    <span class="tx-18 mt-4">Loan Payoff Calculator</span>
    <div class="col-sm-12 col-md-12 col-lg-6 col-xl-6 mt-4">
        <div class="card tx-12">
            <div class="card-body">
                <div class="d-flex flex-column align-items-center mt-3">
                    <span class="tx-bold">What will it take to pay off my Loan?</span>
                    <form class="mt-4 w-100" id="loanForm">
                        <div class="form-group mb-3">
                            <label>Enter your Loan balance: $</label>
                            <input type="number" class="form-control" id="loanBalance" step="0.01" required>
                        </div>
                        <div class="form-group mb-3">
                            <label>Enter the Loan interest rate: %</label>
                            <input type="number" class="form-control" id="loanRate" step="0.01" required>
                        </div>
                        <div class="form-group mb-3">
                            <label>Enter payment amount per month: $</label>
                            <input type="number" class="form-control" id="monthlyPayment" step="0.01">
                        </div>
                        <span class="tx-bold">or</span>
                        <div class="form-group mt-3 mb-3">
                            <label>Enter desired months until debt free: </label>
                            <input type="number" class="form-control" id="desiredMonths">
                        </div>
                        <button type="button" class="btn btn-primary w-100" onclick="calculateLoanPayoff()">Calculate</button>
                    </form>
                    <div id="loanResults" class="mt-3 w-100" style="display: none;">
                        <div class="alert alert-info">
                            <div id="loanResultText"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Compound Interest Calculator -->
    <span class="tx-18 mt-4">Compound Interest Calculator</span>
    <div class="col-sm-12 col-md-12 col-lg-6 col-xl-6 mt-4">
        <div class="card tx-12">
            <div class="card-body">
                <div class="d-flex flex-column align-items-center mt-3">
                    <span class="tx-bold">Maximus Title</span>
                    <form class="mt-4 w-100" id="compoundForm">
                        <div class="d-flex flex-row">
                            <div class="col-sm-8 col-md-8 col-lg-8 col-xl-8">
                                <div class="form-group mb-3">
                                    <label>Principal</label>
                                    <input type="number" class="form-control" id="principal" step="0.01" required>
                                </div>
                                <div class="form-group mb-3">
                                    <label>Rate %</label>
                                    <input type="number" class="form-control" id="compoundRate" step="0.01" required>
                                </div>
                                <div class="form-group mb-3">
                                    <label>Years</label>
                                    <input type="number" class="form-control" id="years" step="0.1" required>
                                </div>
                                <span>Compound Interest Calculation Results</span>
                                <div class="form-group mt-2 mb-3">
                                    <label>Amount</label>
                                    <input type="text" class="form-control readonly-result" id="compoundAmount" readonly>
                                </div>
                                <div class="form-group mb-3">
                                    <label>Interest</label>
                                    <input type="text" class="form-control readonly-result" id="compoundInterest" readonly>
                                </div>
                            </div>
                            <div class="card tx-10 col-sm-4 col-md-4 col-lg-4 col-xl-4">
                                <div class="card-body bg-gray-300 d-flex flex-column align-items-center justify-content-center">
                                    <span class="tx-bold">Months</span>
                                    <div class="listgroup-example mt-3">
                                        <ul class="list-group">
                                            <li>1 = .08</li>
                                            <li>2 = .17</li>
                                            <li>3 = .25</li>
                                            <li>4 = .33</li>
                                            <li>5 = .42</li>
                                            <li>6 = .50</li>
                                            <li>7 = .58</li>
                                            <li>8 = .67</li>
                                            <li>9 = .75</li>
                                            <li>10 = .83</li>
                                            <li>11 = .92</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <button type="button" class="btn btn-primary me-2" onclick="calculateCompoundInterest()">Calculate</button>
                            <button type="button" class="btn btn-primary" onclick="clearCompoundForm()">Clear</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Monthly Mortgage Calculator -->
    <span class="tx-18 mt-4">Monthly Mortgage Calculator with Amortization</span>
    <div class="col-sm-12 col-md-12 col-lg-6 col-xl-6 mt-4">
        <div class="card tx-12">
            <div class="card-body">
                <div class="d-flex flex-column align-items-center mt-3">
                    <form class="mt-4 w-100" id="mortgageForm">
                        <div class="form-group mb-3">
                            <label>First Payment Year</label>
                            <select class="form-control form-select" id="firstPaymentYear">
                                <option>2009</option>
                                <option>2010</option>
                                <option>2011</option>
                                <option>2012</option>
                                <option>2013</option>
                                <option>2015</option>
                                <option>2016</option>
                                <option>2017</option>
                                <option>2018</option>
                                <option>2019</option>
                                <option>2020</option>
                                <option>2021</option>
                                <option>2022</option>
                                <option>2023</option>
                                <option>2024</option>
                                <option selected>2025</option>
                            </select>
                        </div>
                        <div class="form-group mb-3">
                            <label>Mortgage Amount</label>
                            <input type="number" class="form-control" id="mortgageAmount" step="0.01" required>
                        </div>
                        <div class="form-group mb-3">
                            <label>Interest Rate %</label>
                            <input type="number" class="form-control" id="mortgageRate" step="0.01" required>
                        </div>
                        <div class="form-group mb-3">
                            <label>Mortgage Length</label>
                            <select class="form-control form-select" id="mortgageLength">
                                <option value="30" selected>30 Years</option>
                                <option value="25">25 Years</option>
                                <option value="15">15 Years</option>
                                <option value="10">10 Years</option>
                                <option value="7">7 Years</option>
                                <option value="5">5 Years</option>
                            </select>
                        </div>
                        <button type="button" class="btn btn-primary w-100 mb-2" onclick="calculateMortgage()">Calculate</button>
                        <button type="button" class="btn btn-primary w-100 mb-2" onclick="resetMortgageForm()">Reset</button>
                        <button type="button" class="btn btn-primary w-100" onclick="showAmortization()">Amortize</button>
                    </form>

                    <div class="w-100 mt-5">
                        <span>Mortgage Calculation Results</span>
                        <div class="form-group mt-2 mb-3">
                            <label>Payment Amount</label>
                            <input type="text" class="form-control readonly-result" id="paymentAmount" readonly>
                        </div>
                        <div class="form-group mb-3">
                            <label>Total Interest</label>
                            <input type="text" class="form-control readonly-result" id="totalInterest" readonly>
                        </div>
                        <span class="text-muted small">
                            DISCLAIMER: The figures above are based upon conventional program guidelines. Calculations by this tool are believed to be accurate, yet are not guaranteed. Further review is necessary to obtain an exact qualification. If you have less than 20% equity in your home, a monthly mortgage insurance payment may be required.
                        </span>
                    </div>

                    <!-- Amortization Table -->
                    <div id="amortizationTable" class="w-100 mt-4" style="display: none;">
                        <h5>Amortization Schedule</h5>
                        <div class="table-responsive">
                            <table class="table table-striped table-sm">
                                <thead>
                                    <tr>
                                        <th>Year #</th>
                                        <th>Year</th>
                                        <th>Balance</th>
                                        <th>Principal</th>
                                        <th>Interest</th>
                                        <th>Remaining Balance</th>
                                    </tr>
                                </thead>
                                <tbody id="amortizationBody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Loan Payoff Calculator
    function calculateLoanPayoff() {
        const balance = parseFloat(document.getElementById('loanBalance').value);
        const rate = parseFloat(document.getElementById('loanRate').value) / 100 / 12;
        const monthlyPayment = parseFloat(document.getElementById('monthlyPayment').value);
        const desiredMonths = parseFloat(document.getElementById('desiredMonths').value);

        if (!balance || !rate || rate < 0) {
            alert('Please enter valid loan balance and interest rate.');
            return;
        }

        let resultText = '';

        if (monthlyPayment && monthlyPayment > 0) {
            // Calculate months to pay off with given payment
            if (monthlyPayment <= balance * rate) {
                resultText = 'Monthly payment is too low to pay off the loan. Minimum payment needed: $' + (balance * rate + 1).toFixed(2);
            } else {
                const months = Math.ceil(-Math.log(1 - (balance * rate) / monthlyPayment) / Math.log(1 + rate));
                const totalPaid = monthlyPayment * months;
                const totalInterest = totalPaid - balance;

                resultText = `
                    <strong>Time to pay off:</strong> ${months} months (${Math.floor(months/12)} years, ${months%12} months)<br>
                    <strong>Total amount paid:</strong> $${totalPaid.toFixed(2)}<br>
                    <strong>Total interest paid:</strong> $${totalInterest.toFixed(2)}
                `;
            }
        } else if (desiredMonths && desiredMonths > 0) {
            // Calculate required monthly payment for desired timeframe
            const requiredPayment = (balance * rate * Math.pow(1 + rate, desiredMonths)) / (Math.pow(1 + rate, desiredMonths) - 1);
            const totalPaid = requiredPayment * desiredMonths;
            const totalInterest = totalPaid - balance;

            resultText = `
                <strong>Required monthly payment:</strong> $${requiredPayment.toFixed(2)}<br>
                <strong>Total amount paid:</strong> $${totalPaid.toFixed(2)}<br>
                <strong>Total interest paid:</strong> $${totalInterest.toFixed(2)}
            `;
        } else {
            alert('Please enter either a monthly payment amount or desired months to pay off.');
            return;
        }

        document.getElementById('loanResultText').innerHTML = resultText;
        document.getElementById('loanResults').style.display = 'block';
    }

    // Compound Interest Calculator
    function calculateCompoundInterest() {
        const principal = parseFloat(document.getElementById('principal').value);
        const rate = parseFloat(document.getElementById('compoundRate').value) / 100;
        const years = parseFloat(document.getElementById('years').value);

        if (!principal || !rate || !years || principal <= 0 || rate < 0 || years <= 0) {
            alert('Please enter valid positive values for all fields.');
            return;
        }

        // Compound annually
        const amount = principal * Math.pow(1 + rate, years);
        const interest = amount - principal;

        document.getElementById('compoundAmount').value = '$' + amount.toFixed(2);
        document.getElementById('compoundInterest').value = '$' + interest.toFixed(2);
    }

    function clearCompoundForm() {
        document.getElementById('principal').value = '';
        document.getElementById('compoundRate').value = '';
        document.getElementById('years').value = '';
        document.getElementById('compoundAmount').value = '';
        document.getElementById('compoundInterest').value = '';
    }

    // Mortgage Calculator
    function calculateMortgage() {
        const amount = parseFloat(document.getElementById('mortgageAmount').value);
        const rate = parseFloat(document.getElementById('mortgageRate').value) / 100 / 12;
        const years = parseInt(document.getElementById('mortgageLength').value);
        const months = years * 12;

        if (!amount || !rate || !years || amount <= 0 || rate < 0 || years <= 0) {
            alert('Please enter valid values for all fields.');
            return;
        }

        // Calculate monthly payment using mortgage formula
        const monthlyPayment = (amount * rate * Math.pow(1 + rate, months)) / (Math.pow(1 + rate, months) - 1);
        const totalPaid = monthlyPayment * months;
        const totalInterest = totalPaid - amount;

        document.getElementById('paymentAmount').value = '$' + monthlyPayment.toFixed(2);
        document.getElementById('totalInterest').value = '$' + totalInterest.toFixed(2);

        // Store values for amortization
        window.mortgageData = {
            amount: amount,
            rate: rate,
            months: months,
            monthlyPayment: monthlyPayment,
            startYear: parseInt(document.getElementById('firstPaymentYear').value)
        };
    }

    function resetMortgageForm() {
        document.getElementById('mortgageAmount').value = '';
        document.getElementById('mortgageRate').value = '';
        document.getElementById('firstPaymentYear').value = '2025';
        document.getElementById('mortgageLength').value = '30';
        document.getElementById('paymentAmount').value = '';
        document.getElementById('totalInterest').value = '';
        document.getElementById('amortizationTable').style.display = 'none';
        window.mortgageData = null;
    }

    function showAmortization() {
        if (!window.mortgageData) {
            alert('Please calculate mortgage first.');
            return;
        }

        const data = window.mortgageData;
        let balance = data.amount;
        const tbody = document.getElementById('amortizationBody');
        tbody.innerHTML = '';

        let currentYear = data.startYear;
        const totalYears = Math.ceil(data.months / 12);

        for (let year = 1; year <= totalYears; year++) {
            let yearlyPrincipal = 0;
            let yearlyInterest = 0;
            const paymentsThisYear = Math.min(12, data.months - (year - 1) * 12);

            // Calculate 12 months (or remaining months) for this year
            for (let month = 1; month <= paymentsThisYear; month++) {
                const monthlyInterest = balance * data.rate;
                const monthlyPrincipal = data.monthlyPayment - monthlyInterest;

                yearlyInterest += monthlyInterest;
                yearlyPrincipal += monthlyPrincipal;
                balance = Math.max(0, balance - monthlyPrincipal);

                if (balance <= 0.01) break;
            }

            const yearlyPayment = data.monthlyPayment * paymentsThisYear;

            const row = tbody.insertRow();
            row.innerHTML = `
                <td>${year}</td>
                <td>${currentYear}</td>
                <td>${yearlyPayment.toFixed(2)}</td>
                <td>${yearlyPrincipal.toFixed(2)}</td>
                <td>${yearlyInterest.toFixed(2)}</td>
                <td>${balance.toFixed(2)}</td>
            `;

            currentYear++;

            if (balance <= 0.01) break; // Stop when loan is paid off
        }

        document.getElementById('amortizationTable').style.display = 'block';
    }

    // Initialize default values
    document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('firstPaymentYear').value = '2025';
    });
</script>